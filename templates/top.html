<link rel="stylesheet" href="/styles/top.css" />

<div id="map">
  <img id="world" src="/images/map_red.png">

  {% for city in cities %} 
  <div id="{{city.id}}" class="pin-container">
    <a alt="{{city.label}}"
      {% if city.id == "tokyo" %}
        href="/{{lang}}/test_city_tokyo"
      {% else %}
        href="/{{lang}}/cities/{{city.id}}"
      {% endif %}
    >
      <div class="pin">
        <div class="point">
          <img src="/images/cities/{{city.id}}_white.png">
          <div class="city">
            <span>{{city.label}}</span>
          </div>
        </div>
        <div class="bar"></div>
      </div>
    </a>
  </div>
  {% endfor %}
  <div id="vehicles">
    <div id="ship" class="vehicle">
      <div class="balloon">
        <p><span id="facebooklikes">...</span></p>
        <p>Facebook Likes</p>
      </div>
      <img src="/images/vehicles/ship.png">
    </div>
    <div id="plane" class="vehicle">
      <img src="/images/vehicles/plane.png">
    </div>
    <div id="submarine" class="vehicle">
      <img src="/images/vehicles/submarine.png">
    </div>
    <div id="ufo" class="vehicle">
      <div class="balloon">
        <p>{% if lang == 'en' %}
             Welcome to the World in Twelve!! Leo is currently in Tokyo!!
           {% else %}
             ”World in Twelve”へようこそ！いま現在、東京にいるよ！
           {% endif %}
        </p>
      </div>
      <img src="/images/vehicles/ufo.png">
    </div>
  </div>
</div>
<script>
  var cities_ = "{% for city in cities %}_{{city.id}}{% endfor %}";
  var cities = cities_.split("_").slice(1);
  var i = 0;
  setInterval(function() {
    var element = document.getElementById(cities[i]);
    element.classList.add('selected');
    setTimeout(function() {
      element.classList.remove('selected');
    }, 2000);
    i = (i == cities.length - 1) ? 0 : i + 1;
  }, 5000);

  var facebookCallback = function(data) {
    var span = document.getElementById('facebooklikes');
    span.innerText = data.likes;
  };
</script>
<script
src="http://graph.facebook.com/worldintwelve/?callback=facebookCallback"></script>
